---
layout: post
title: Permanent Link to Using helpers in a controller: with_helpers
author: warren
---
      
					<p>Although there is supposed to be a clear separation between views and controllers, often when it comes to helper functions, there is a small bit of overlap and there are situations where it’d be nice to simply use a few helpers from inside an action.</p>
<div class="CodeRay">
<div class="code">
<pre><span style="color:#036; font-weight:bold">ActionController</span>::<span style="color:#036; font-weight:bold">Base</span>.class_eval <span style="color:#080; font-weight:bold">do</span>
  <span style="color:#080; font-weight:bold">def</span> <span style="color:#06B; font-weight:bold">with_helpers</span>(&amp;block)
    template = <span style="color:#036; font-weight:bold">ActionView</span>::<span style="color:#036; font-weight:bold">Base</span>.new([],{},<span style="color:#038; font-weight:bold">self</span>)
    template.extend <span style="color:#038; font-weight:bold">self</span>.class.master_helper_module
    add_variables_to_assigns
    template.assigns = <span style="color:#33B">@assigns</span>
    template.send(<span style="color:#A60">:assign_variables_from_controller</span>)
    forget_variables_added_to_assigns
    template.instance_eval(&amp;block)
  <span style="color:#080; font-weight:bold">end</span>
<span style="color:#080; font-weight:bold">end</span></pre>
</div>
</div>
<p>Here is what it looks like in a controller.  Although this is a non-sensical example, it shows off how you can use a helper (i.e. link_to) in an action. It also shows how the instance variables (i.e. @person) set in the action are available in the with_helpers block… the same way that instance variables are available in views.</p>
<div class="CodeRay">
<div class="code">
<pre><span style="color:#080; font-weight:bold">class</span> <span style="color:#B06; font-weight:bold">MyController</span> &lt; <span style="color:#036; font-weight:bold">ApplicationController</span>
  <span style="color:#080; font-weight:bold">def</span> <span style="color:#06B; font-weight:bold">my_action</span>
    <span style="color:#33B">@person</span> = <span style="color:#036; font-weight:bold">Person</span>.find(params[<span style="color:#A60">:id</span>])
    render <span style="color:#A60">:text</span> =&gt; with_helpers { link_to(<span style="color:#33B">@person</span>.full_name, person_path(<span style="color:#33B">@person</span>)) }
  <span style="color:#080; font-weight:bold">end</span>
<span style="color:#080; font-weight:bold">end</span></pre>
</div>
</div>
				